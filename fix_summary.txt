# Fix Summary

## Files Changed

### 1. docs/examples/django/manage.py
**Change**: Added TracerProvider and ConsoleSpanExporter setup

**Diff Summary**:
- Added imports for `trace`, `TracerProvider`, `BatchSpanProcessor`, `ConsoleSpanExporter`
- Added TracerProvider setup code before `DjangoInstrumentor().instrument()` call

```diff
 import os
 import sys
 
+from opentelemetry import trace
 from opentelemetry.instrumentation.django import DjangoInstrumentor
+from opentelemetry.sdk.trace import TracerProvider
+from opentelemetry.sdk.trace.export import (
+    BatchSpanProcessor,
+    ConsoleSpanExporter,
+)
 
 
 def main():
     os.environ.setdefault(
         "DJANGO_SETTINGS_MODULE", "instrumentation_example.settings"
     )
 
+    # Set up tracing with console exporter to see spans in stdout
+    trace.set_tracer_provider(TracerProvider())
+    trace.get_tracer_provider().add_span_processor(
+        BatchSpanProcessor(ConsoleSpanExporter())
+    )
+
     # This call is what makes the Django application be instrumented
     DjangoInstrumentor().instrument()
```

### 2. docs/examples/django/README.rst
**Change**: Updated documentation to explain TracerProvider requirement

**Diff Summary**:
- Replaced single sentence about `DjangoInstrumentor().instrument()` with detailed explanation
- Added numbered list of required setup steps
- Added complete code example showing proper configuration
- Added explanation of what happens without the setup

---

## Commands Run for Testing and Linting

### Linting
```bash
$ tox -e ruff
```
**Result**: PASSED
- ruff (legacy alias): Passed
- ruff format: Passed  
- uv-lock: Passed
- rstcheck: Passed

### SDK Tests
```bash
$ tox -e py312-test-opentelemetry-sdk
```
**Result**: PASSED (636 passed, 8 warnings in 18.63s)

### Manual Verification
```bash
$ python docs/getting_started/tracing_example.py
```
**Result**: Successfully produced JSON span output confirming TracerProvider/ConsoleSpanExporter pattern works

```bash
$ python -c "
from opentelemetry import trace
from opentelemetry.sdk.trace import TracerProvider
from opentelemetry.sdk.trace.export import BatchSpanProcessor, ConsoleSpanExporter
trace.set_tracer_provider(TracerProvider())
trace.get_tracer_provider().add_span_processor(BatchSpanProcessor(ConsoleSpanExporter()))
print('Setup successful!')
"
```
**Result**: "Setup successful!" - confirming imports and setup code work correctly

---

## Test Results

### tox -e ruff
```
ruff (legacy alias)......................................................Passed
ruff format..............................................................Passed
uv-lock..................................................................Passed
rstcheck.................................................................Passed
  ruff: OK (23.18=setup[0.40]+cmd[22.78] seconds)
  congratulations :) (23.30 seconds)
```

### tox -e py312-test-opentelemetry-sdk
```
======================= 636 passed, 8 warnings in 18.63s =======================
  py312-test-opentelemetry-sdk: OK (19.53=setup[0.51]+cmd[19.02] seconds)
  congratulations :) (19.64 seconds)
```

### tox -e py312-test-opentelemetry-getting-started
```
1 failed (test_flask - unrelated network issue), 3 passed
```
Note: The Flask test failure is due to network restrictions in the test environment (unable to reach www.example.com), not related to this fix.

---

## Remaining Risks or Follow-ups

### Low Risk
1. **Django example not directly testable**: The Django example cannot be fully integration tested in this sandbox environment due to the need for Django dependencies and running a server. However, the code pattern matches the working Flask example.

### Potential Follow-ups
1. **Consider adding a Django integration test**: Similar to `test_flask.py`, a test could be added for the Django example to catch similar issues in the future.

2. **Auto-instrumentation section**: The README.rst mentions that auto-instrumentation (`opentelemetry-instrument python manage.py runserver`) works without manual setup. This should be tested to ensure it still functions correctly (it uses environment-based configuration).

3. **Consider adding this to CHANGELOG.md**: Depending on project policy, this documentation fix might warrant an entry in the main CHANGELOG.md under a "Documentation" section.

---

## Summary

This fix resolves the issue where Django instrumentation documentation examples did not produce any visible OpenTelemetry output. The root cause was missing TracerProvider and SpanProcessor setup. The fix adds the necessary configuration to match the pattern used in other examples like Flask.
